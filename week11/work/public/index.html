<!DOCTYPE html>
<html>

<head>
  <link rel='stylesheet' href='/stylesheets/style.css' />
  <link href="https://cdn.bootcss.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet">

</head>

<body>
  <div class="container">
    <nav class="nav .justify-content-center col">
      <a class="nav-link active" href="#">首页</a>
      <a class="nav-link" href="#">产品</a>
      <a class="nav-link" href="#">关于我们</a>
      <a class="nav-link disabled" href="#">敬请期待</a>
    </nav>
    <div class="custom-file">
      <input type="file" class="custom-file-input uploadPic" id="customFile">
      <label class="btn btn-primary realFile" for="customFile">上传相册</label>
    </div>

    <div class="content row">
      <div class="col-12 line"></div>
    </div>
  </div>
</body>
<script src="https://lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../javascripts/readfile.js"></script>

<script>
  const box = $(".content");
  const uploadPic = $(".uploadPic");
  uploadPic.change(createReader(readImage));
  function readImage(img) {
    fetch("/addPic",{
      method:"POST",
      headers:{
         'Content-Type': 'application/json'
      },
      body:JSON.stringify({"img":img.src})
    }).then(res=>res.json()).then(function(result){
      console.log(result);
      box.append(addPicture(result.img));
    })
    // $.post("/addPic",img,function(res){
    //   const picBox = $("<div>").attr("class","col-1 picBox");
    //   const box = $(".content");
    //   picBox.append(res);
    //   box.append(picBox);
    // })
  }
  $.get("/initPic",function(res){
    console.log(res);
    res.forEach(val=>{
      box.append(addPicture(val.img));
    })
  })
  function addPicture(data){
    return`
      <div class="col-1 picBox">
        <img src=${data} alt="照片" />
      </div>
    `
  }

</script>

</html>
